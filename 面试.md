### 自我介绍：

“面试官您好，非常荣幸参与贵公司应聘，下面我简单介绍一下我的个人情况，

首先介绍一下之前的工作经验：**目前就职于厦门本能管家科技有限公司，工作期间主要负责公司内部协作软件的开发和后台管理系统的维护与开发。如简历上所写，该内部协作软件用到的技术栈是Angular+Electron制作的桌面端即时通讯应用，定位类似于字节跳动的飞书和阿里的钉钉，后台管理系统主要使用vue和ElementUI开发，主要用于对用户的和平台的运营**。之所以离开上一家公司是出于个人成长和职业发展考虑。

通过boss直聘关注到贵公司岗位的招聘信息，而且贵公司的业务：IT资讯、汽车资讯和时尚资讯，对我都非常有吸引力，非常渴望能够进入贵公司发展……

我个人的基本情况是（受教育情况、婚育、住所、家庭简单情况），闲暇之余，我一般会做些健身事情和看一些书籍。

或许在所有的求职者当中，我不是最优秀的，但如果贵公司能够给我这个工作机会，我有信心，也有决心做好这份工作，以上是我的个人基本情况，希望今天自己面试有好的表现，未来有幸与诸位面试官共事，也预祝各位度过美好的一天。

### 项目经验：

1. websocket： HTML5开始提供的一种浏览器与服务器进行全双工通讯的网络技术，属于应用层协议。它基于TCP传输协议，并复用HTTP的握手通道。 

   - WebSocket可以在浏览器里使用
- 支持双向通信
   - 较少的控制开销。连接创建后，ws客户端、服务端进行数据交换时，协议控制的数据包头部较小。 

2. 网络连接: 

   udp协议虽然实时性更好,但是如何处理安全可靠的传输并且处理不同客户端之间的消息交互是个难题，实现起来过于复杂. 目前大部分IM架构都不采用UDP来实现.

   但是为啥还需要HTTP呢?

   - 核心的TCP长连接,用来实时收发消息,其他资源请求不占用此连接,保证实时性
   - http可以用来实现状态协议

3. 心跳重连：

   - 原因：  网络断开的情况，比如信号不好，或者网络临时关闭，  并不会理想执行`websocket`的`onclose`方法。 无法知道是否断开连接，也就无法进行重连操作。 保证客户端和服务端保证彼此还活着，避免丢包发生。 

   - 实现：在连接成功的时候开始利用方法发送心跳包，在onmessage事件触发取消心跳包，并发送下一个心跳，超出限定时长后触发close事件，断开连接。或者使用 ws库中的 `ws.ping('', false, true);` 方法。

4. 消息保序：

- 出发点：

  网络异常了,收不到消息,服务端就会重发或者转离线存储(**xxx项目的机制立即转离线存储**)，对于离线消息, 可能有很多条，拉取的时候需要保证顺序。

- 方案：

  - 每条消息到服务端后,都会生成一个全局唯一的msgid, 这个msgid一定都是递增增长的(**msgid的生成会有同步机制保证并发时的唯一性**)

  - 针对每条消息,会有消息的生成时间,精确到毫秒

  - 拉取多条消息的时候,取出数据后,再根据msgid的大小进行排序即可

5. 保证消息唯一性：

   - 出发点： 网络的不稳定性 ， 重发机制， 消息可能会重复 
   - 方案： 客户端和服务端相关处理 ,
     - 消息meta结构里面增加一个字段isResend. 客户端重复发送的时候置位此字段,标识这个是重复的,服务端用来后续判断
     - 服务端为每个用户缓存一批最近的msgids(所谓的localMsgId),如缓存50条
     - 服务端收到消息后, 通过判断isResend和此msgid是否在localMsgId list中. 如果重复发送,则服务端不做后续处理.

6. 断线重连机制：

    	本地网络出错，并不需要定时去重连，这时只需要监听网络状态，等到网络恢复后重连即可。  如果网络变化非常频繁， 断线重连的最短间隔时间按单位秒(s)以4、8、16...（最大不超过30）数列执行，以避免频繁的断线重连，从而减轻服务器负担。当服务端收到正确的包时，此策略重置。

   